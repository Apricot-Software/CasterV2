<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=2">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caster</title>
    <link rel="stylesheet" href="static/style/style.css">
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <img src="static/img/casterlogo.png" width="50px">
        </div>
        <div class="content">
            <div class="left-bar">
                <a class="bar-button ab-text" onclick="window.location.href = '/'"><img src="static/img/home.png" class="bar-button-icon"><span class="bar-text">Home</span></a>
                <a class="bar-button ab-text" onclick="window.location.href = '/profile'"><img src="static/img/profile.png" class="bar-button-icon"><span class="bar-text">Profile</span></a>
                <a class="bar-button ab-text" onclick="window.location.href = '/search'"><img src="static/img/search.png" class="bar-button-icon"><span class="bar-text">Search</span></a>
                <a class="bar-button ab-text" onclick="window.location.href = '/create'"><img src="static/img/pencil.png" class="bar-button-icon"><span class="bar-text">Post</span></a>
                <a class="bar-button ab-text" onclick="window.location.href = '/settings'"><img src="static/img/settings.png" class="bar-button-icon"><span class="bar-text">Settings</span></a>
            </div>
            <div class="main-content">
                <div class="post-flex-box" id="post-flex-box">
                    <div class="post-container">
                        <p class="user-bar">
                            <img class="user-pfp" src="{{ pfp }}">
                            <a class="display-name" href="/profile?user={{ handle }}">{{ displayName }}</a>
                            <span class="handle">@{{ handle }} â€¢ {{ timestamp }}</span>
                        </p>
                        <p class="post-text">{{ postContent | safe }}</p>
                        <div class="post-action-bar">
                            <span>
                                <img src="static/img/like-unselect.png" class="like-icon">
                                <a class="ab-text">0</a>
                            </span>
                            <span>
                                <img src="static/img/message.png" class="like-icon">
                                <a class="ab-text">0</a>
                            </span>
                            <span>
                                <img src="static/img/share.png" class="like-icon">
                                <a class="ab-text">0</a>
                            </span>
                        </div>

                    </div>
                    <div class="poster-container">
                        <img class="user-pfp" src="{{ user_pfp }}"><div id="post-input" class="post-input" placeholder="Say something..." oninput="if(this.innerHTML.trim()==='<br>')this.innerHTML=''" contentEditable></div><button class="positiveButton post-text" onclick="sendPost()">Post</button>
                    </div>
                </div>

                <div class="spacer"></div>
            </div>
            <div class="right-bar">
                <h1>Coming Soon</h1>
            </div>
        </div>
    </div>
</body>
<script>
    function sendPost() {
    const postContent = document.getElementById('post-input').innerText;

    if (postContent === '') {
        alert('Post content cannot be empty.');
        return
    }

    fetch('/api/sendrefpost?refid={{ post_id }}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ content: postContent })
    })
}
</script>
</html>
